
<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
 <title>Pháº§n 4</title>

  <!-- Google Fonts -->
  <link
    href="https://fonts.googleapis.com/css2?family=Noto+Serif&family=Playfair+Display:wght@600;700&display=swap"
    rel="stylesheet"
  >

  <!-- Style dÃ¹ng chung -->
  <link rel="stylesheet" href="../style.css">
</head>

<body class="page-chapter">
<body class="page-chapter">

  <!-- ===== NÃšT Má» THÆ¯ VIá»†N (TRÃI) ===== -->
  <div class="menu-toggle" onclick="toggleLibrary()">â˜°</div>

  <div class="overlay" id="overlay" onclick="toggleLibrary()"></div>

  <div class="library-sidebar" id="librarySidebar">
    <div class="library-header">
      ğŸ“š ThÆ° viá»‡n
      <span class="close-btn" onclick="toggleLibrary()">âœ•</span>
    </div>

    <input type="text" id="searchInput" placeholder="TÃ¬m truyá»‡n..." />
    <ul id="storyList"></ul>
  </div>


  <!-- ===== NÃšT Má» Má»¤C Lá»¤C (PHáº¢I) ===== -->
  <div class="chapter-menu-toggle" onclick="toggleChapterMenu()">ğŸ“‘</div>

  <div id="chapterOverlay" class="chapter-overlay" onclick="toggleChapterMenu()"></div>

  <div id="chapterSidebar" class="chapter-sidebar">
    <div class="chapter-sidebar-header">
      ğŸ“š Má»¥c lá»¥c
      <span class="close-btn" onclick="toggleChapterMenu()">âœ•</span>
    </div>

    <ul id="chapterList"></ul>
  </div>
<!-- ================= HEADER ================= -->
<div class="fixed-top">
  <div class="fixed-inner page-chapter">

    <!-- LEFT -->
    <div class="top-left">
      <a class="back-link" href="../index.html">ğŸ“‘ Má»¥c lá»¥c</a>
      <a class="back-link" href="../../../index.html">ğŸ  Trang chá»§</a>
      <a class="back-link" href="../../../thu-vien-ten/name-library.html">ğŸ“– ThÆ° viá»‡n tÃªn</a>
      <button id="bookmarkBtn" class="back-link">ğŸ“Œ Káº¹p sÃ¡ch</button>
    </div>
    <!-- CENTER -->
    <div class="novel-header top-center">
      <h1 class="novel-title">
        Cháº¥n Äá»™ng Sá»Ÿ Cáº£nh SÃ¡t ÄÃ´ Thá»‹ 1200 Váº¡n Con Tin ã€Xem áº¢nh Thá»ƒã€‘
      </h1>
      <div class="novel-meta">
        <span>Pháº§n 4</span>
      </div>
    </div>

    <!-- RIGHT -->
    <div class="top-right">
      <a class="back-link" href="phan3.html">â® ChÆ°Æ¡ng trÆ°á»›c</a>
      <a class="back-link" href="phan5.html">â­ ChÆ°Æ¡ng sau</a>
    </div>
  </div>
</div>

<!-- ================= CONTENT ================= -->
<main>
<div class="content chapter-content">

        <p>â€œLan.â€ Edogawa Conan nhÆ° váº­y tÆ°Æ¡ng Ä‘Æ°Æ¡ng trá»±c tiáº¿p tháº³ng tháº¯n. â€ƒâ€ƒ</p>
        <p>â€ƒâ€ƒMouri Ran nÆ°á»›c máº¯t váº«n lÃ  cháº£y xuá»‘ng dÆ°á»›i: â€œShinichiâ€¦â€ â€ƒâ€ƒ</p>
        <p>â€ƒâ€ƒ â€œThá»±c xin lá»—i, lan.â€ Háº¯n dá»«ng má»™t chÃºt, â€œTa chá»‰ lÃ  khÃ´ng nghÄ© Ä‘em ngÆ°Æ¡i liÃªn lá»¥y Ä‘i vÃ o.â€ â€ƒâ€ƒ</p>
        <p>â€ƒâ€ƒ â€œTa, ta biáº¿t Ä‘áº¿nâ€¦â€ Shinichi thÃ¢n thá»ƒ tháº­m chÃ­ Ä‘á»u thu nhá», thuyáº¿t minh cÃ¡i nÃ y Ã¡n kiá»‡n khÃ´ng pháº£i giá»‘ng nhau nguy hiá»ƒm, nÃ ng thanh Ã¢m cÃ³ chÃºt ngháº¹n ngÃ o, â€œNgÆ°Æ¡i tháº­t sá»± cho ráº±ng ta lÃ  Ä‘á»“ ngá»‘c saoâ€¦?!â€ â€ƒâ€ƒ</p>
        <p>â€ƒâ€ƒ láº§n nÃ y sá»­ng sá»‘t Ä‘áº¿n phiÃªn Edogawa Conan, hoáº·c lÃ  kÃªu Kudo Shinichi. â€ƒâ€ƒ</p>
        <p>â€ƒâ€ƒ â€œNgÆ°Æ¡iâ€¦ ÄÃ£ sá»›m biáº¿t?â€ â€ƒâ€ƒ</p>
        <p>â€ƒâ€ƒMouri Ran gáº­t gáº­t Ä‘áº§u, láº¡i láº¯c Ä‘áº§u: â€œTuy ráº±ng má»—i láº§n Ä‘á»u sáº½ Ä‘Ã¡nh máº¥t ta hoÃ i nghi, Shinichiâ€¦ NgÆ°Æ¡i liá»n sáº½ khÃ´ng suy Ä‘oÃ¡n má»™t chÃºt ta tÃ¢m lÃ½ sao?â€ â€ƒâ€ƒ</p>
        <p>â€ƒâ€ƒ â€œâ€¦ Ta á»Ÿ LuÃ¢n ÄÃ´n thá»i Ä‘iá»ƒm liá»n nÃ³i qua Ä‘i, muá»‘n suy Ä‘oÃ¡n ra thÃ­ch ná»¯ hÃ i tÃ¢m lÃ½ tháº­t sá»± ráº¥t khÃ³ a!â€ â€ƒâ€ƒ</p>
        <p>â€ƒâ€ƒ cho dÃ¹ nÃ ng Ä‘Ã£ nghe qua má»™t láº§n háº¯n thÃ´ng bÃ¡o, nhÆ°ng váº«n lÃ  nhá»‹n khÃ´ng Ä‘Æ°á»£c giáº­t mÃ¬nh táº¡i chá»—. â€ƒâ€ƒ</p>
        <p>â€ƒâ€ƒ â€œTa Ä‘ang Ä‘á»£i ngÆ°Æ¡i chÃ­nh miá»‡ng nÃ³i cho ta a, ngu ngá»‘c Shinichi.â€ â€ƒâ€ƒ</p>
        <p>â€ƒâ€ƒâ€¦â€¦ ( náº¿u cÃ³ hÃ¬nh áº£nh, nÆ¡i nÃ y tiá»ƒu kha háº³n lÃ  Ä‘Ã£ khiáº¿p sá»£ ra Ä‘áº¡i hÃ o. ) â€ƒâ€ƒ</p>
        <p>â€ƒâ€ƒ ngÆ°á»£c láº¡i lÃ  Haibara Ai, nÃ ng láº¡i lÃ¢m vÃ o tá»± trÃ¡ch bÃªn trong. Náº¿u chÃ­nh mÃ¬nh khÃ´ng cÃ³ nghiÃªn cá»©u cÃ¡i loáº¡i nÃ y dÆ°á»£câ€¦â€¦ NghÄ© láº¡i tÆ°á»Ÿng tÆ°á»£ng, má»¥ má»¥ á»Ÿ nÃ³i, giáº£i dÆ°á»£c nháº¥t Ä‘á»‹nh sáº½ nghiÃªn cá»©u cÃ ng thuáº­n lá»£i Ä‘i. â€ƒâ€ƒ</p>
        <p>â€ƒâ€ƒã€Mouri Ran muá»‘n cÃ¹ng Sonoko Ä‘i Ã´n táº­p, Conan cÃ¹ng thiáº¿u niÃªn trinh thÃ¡m Ä‘oÃ n nhá»¯ng ngÆ°á»i khÃ¡c cÃ¹ng Ä‘i ly há»™ thÆ°Æ¡ng trÆ°á»ng, nÆ¡i Ä‘Ã³ cÃ³ cÃ¡i Ä‘áº¡i bÃ¡nh xe quay. ã€‘â€ƒâ€ƒ</p>
        <p>â€ƒâ€ƒMouri Ran nhÃ¬n Ä‘áº¿n nÆ¡i nÃ y, nhá»› tá»›i trÆ°á»›c kia cÃ¹ng Conan sinh hoáº¡t Ä‘á»§ loáº¡i, tháº­m chÃ­â€¦ CÃ²n cÃ¹ng nhau táº¯m xong!! TrÃºc mÃ£ báº¡n trai biáº¿n thÃ nh Ä‘á»‡ Ä‘á»‡ loáº¡i sá»± tÃ¬nh nÃ y cÃ ng nghÄ© cÃ ng biá»‡t ná»¯u, khÃ´ng biáº¿t chÃ­nh mÃ¬nh trá»™m bá»‹ chiáº¿m quÃ¡ bao nhiÃªu láº§n tiá»‡n nghiâ€¦â€¦â€ƒâ€ƒ</p>
        <p>â€ƒâ€ƒ nÃ ng trá»«ng máº¯t Ä‘Ã£ thÃ¡o xuá»‘ng máº¯t kÃ­nh Edogawa Conan: â€œCÃ´ng, Ä‘áº±ng, tÃ¢n, má»™t!â€ â€ƒâ€ƒ</p>
        <p>â€ƒâ€ƒKudo Shinichi Ä‘Æ°Æ¡ng nhiÃªn biáº¿t báº¡n gÃ¡i nghÄ© tá»›i cÃ¡i gÃ¬, cÃ¹ng nhau sinh hoáº¡t cáº£nh tÆ°á»£ng rÃµ rÃ ng trÆ°á»›c máº¯t, háº¯n trÃªn máº·t mang theo máº¥t tá»± nhiÃªn Ä‘á» á»­ng, cuá»‘ng quÃ­t xua tay: â€œTiá»ƒu Lan tá»· tá»·, a khÃ´ng, lanâ€¦â€ â€ƒâ€ƒ</p>
        <p>â€ƒâ€ƒ ( kha: Sá»­a miá»‡ng cÅ©ng tháº­t khÃ³ aâ€¦ May máº¯n thÃºc thÃºc khÃ´ng á»Ÿ nÆ¡i nÃ y, tuy ráº±ng háº¯n lÃ  má»™t cÃ¡i há»“ Ä‘á»“ trinh thÃ¡m, nhÆ°ng lÃ  vÅ© lá»±c giÃ¡ trá»‹â€¦ ) â€ƒâ€ƒ</p>
        <p>â€ƒâ€ƒã€Takagi Wataru thay Ä‘á»•i cÃ¡i tÃ¢n táº¡o hÃ¬nh, tÃ³c bá»‹ nÄƒng cong cÃ²n Ä‘eo cÃ¡i kÃ­nh rÃ¢m.</p>
        <p>â€ƒâ€ƒ â€œSato cáº£nh sÃ¡t, nhÃ¬n xem ta cÃ¡i nÃ y giáº£ dáº¡ng, ngÆ°Æ¡i cáº£m tháº¥y tháº¿ nÃ o?â€</p>
        <p>â€ƒâ€ƒ â€œTa cÃ¡i dáº¡ng nÃ y cÃ²n cÃ³ thá»ƒ xem Ä‘i?â€</p>
        <p>â€ƒâ€ƒ ai biáº¿t Sato Miwako trá»±c tiáº¿p ngÃ¢y dáº¡i.</p>
        <p>â€ƒâ€ƒ â€œSato cáº£nh sÃ¡tâ€¦? CÃ³ pháº£i hay khÃ´ng nÆ¡i nÃ o khÃ´ng thoáº£i mÃ¡i a?â€</p>
        <p>â€ƒâ€ƒ nÃ ng nhÃ¬n Ä‘áº¿n Tá»­ Tháº§n cáº§m lÆ°á»¡i hÃ¡i Ä‘á»©ng á»Ÿ Takagi phÃ­a sau.</p>
        <p>â€ƒâ€ƒ cuá»‘i cÃ¹ng lÃ  má»™t vá»‹ khÃ¡c ná»¯ cáº£nh gá»i trá»Ÿ vá» Sato, nÃ ng Ä‘á»™t nhiÃªn tá»« há»“i á»©c ra tá»›i.</p>
        <p>â€ƒâ€ƒ tá»« má»¹ nháº¯c nhá»Ÿ nÃ ng buá»•i tá»‘i cÃ¹ng Ä‘i xÆ°á»›ng k, Sato khÃ´ng chÃº Ã½, nÃ ng cÃ³ xÃ³a rá»›t bÆ°u kiá»‡n thÃ³i quen. ã€‘â€ƒâ€ƒ</p>
        <p>â€ƒâ€ƒ â€œÃ” oa, cÃ¡i kia cáº£nh sÃ¡t quáº£ thá»±c chÃ­nh lÃ  phiÃªn báº£n tiá»ƒu Jinpei Ä‘i?â€ â€ƒâ€ƒ</p>
        <p>â€ƒâ€ƒ vÃ i vá»‹ Ä‘á»“ng ká»³ báº¡n tá»‘t sÃ´i ná»•i tÃ¡n Ä‘á»“ng. â€ƒâ€ƒ</p>
        <p>â€ƒâ€ƒMatsuda Jinpei báº£n nhÃ¢n láº¡i khÃ´ng nÃ³i tiáº¿p, háº¯n cuá»‘i cÃ¹ng phÃ¡t cÃ¡i kia tin ngáº¯nâ€¦ Váº«n lÃ  cho nÃ ng mang Ä‘i bá»‘i rá»‘i sao? â€ƒâ€ƒ</p>
        <p>â€ƒâ€ƒHagiwara Kenji chÃº Ã½ tá»›i chÃ­nh lÃ¢m vÃ o tráº§m tÆ° Matsuda Jinpei, háº¯n Ä‘Ã£ sá»›m phÃ¡t hiá»‡n nhÃ  mÃ¬nh osananajimi cÃ¹ng vá»‹ kia kÃªu â€œSatoâ€ ná»¯ cáº£nh quan há»‡ cÃ³ chÃºt vi diá»‡u, báº¥t quÃ¡ nhÃ¬n Matsuda tráº¡ng thÃ¡i háº¯n váº«n lÃ  khÃ´ng cÃ³ chá»c phÃ¡, thuáº­n tay Ä‘em cÃ¡nh tay Ä‘Ã¡p á»Ÿ báº¡n tá»‘t trÃªn vai. â€ƒâ€ƒ</p>
        <p>â€ƒâ€ƒ nhÆ°ng tháº­t ra Morofushi Hiromitsu giá»‘ng nhÆ° nhÃ¬n tháº¥u cÃ¡i gÃ¬ giá»‘ng nhau chá»›p chá»›p thÆ°á»£ng chá»n máº¯t mÃ¨o, cÅ©ng khÃ´ng nÃ³i gÃ¬. â€ƒâ€ƒ</p>
        <p>â€ƒâ€ƒã€ thiáº¿u niÃªn trinh thÃ¡m Ä‘oÃ n máº¥y ngÆ°á»i ngá»“i á»Ÿ bÃ¡nh xe quay thÆ°á»£ng, ba cÃ¡i tháº­t tiá»ƒu hÃ i tá»­ kÃ­ch Ä‘á»™ng mÃ  ghÃ© vÃ o pha lÃª thÆ°á»£ng Ä‘i xuá»‘ng xem, Edogawa Conan váº» máº·t báº¥t Ä‘áº¯c dÄ©, Haibara Ai láº¡i ráº¥t cÃ³ há»©ng thÃº, nhÆ°ng cÅ©ng che giáº¥u khÃ´ng Ä‘Æ°á»£c thÃ nh thá»¥c cáº£m.</p>
        <p>â€ƒâ€ƒSato Miwako cÅ©ng Ä‘i tá»›i nÆ¡i nÃ y, nhÃ¬n Ä‘ang á»Ÿ xoay trÃ²n bÃ¡nh xe quay, Ä‘áº¯m chÃ¬m á»Ÿ trong há»“i á»©c. ã€‘â€ƒâ€ƒ</p>
        <p>â€ƒâ€ƒ náº¿u nÃ³i Shinichi thÃ¢n thá»ƒ Ä‘á»u cÃ³ thá»ƒ thu nhá», kia thoáº¡t nhÃ¬n cÃ ng vÃ¬ thÃ nh thá»¥c tháº­m chÃ­ má»™t chÃºt che giáº¥u Ä‘á»u khÃ´ng cÃ³ Haibara Ai cÃ³ pháº£i hay khÃ´ng cÅ©ngâ€¦â€¦â€ƒâ€ƒ</p>
        <p>â€ƒâ€ƒMouri Ran nghÄ© nhÆ° váº­y, nÃ ng Ã¡nh máº¯t dá»«ng á»Ÿ mÃ u trÃ  tÃ³c ná»¯ hÃ i trÃªn ngÆ°á»i. â€ƒâ€ƒ</p>
        <p>â€ƒâ€ƒHaibara Ai cÅ©ng liá»‡u Ä‘áº¿n chÃ­nh mÃ¬nh thÃ¢n pháº­n luÃ´n cÃ³ báº¡i lá»™ thá»i Ä‘iá»ƒm, báº¥t quÃ¡ Ä‘áº¡i gia tháº­t sá»± cÃ³ thá»ƒ tiáº¿p thu nÃ ng ngÆ°á»i nhÆ° váº­y sao? â€ƒâ€ƒ</p>
        <p>â€ƒâ€ƒ nÃ ng cháº§n chá», láº¡i phÃ¡t hiá»‡n Mouri Ran xem nÃ ng Ã¡nh máº¯t tháº¿ nhÆ°ng Ä‘á»u lÃ  lo láº¯ng. â€ƒâ€ƒ</p>
        <p>â€ƒâ€ƒ â€œâ€¦â€¦?!â€ NÃ ng nhÆ° váº­y tá»« biá»ƒn sÃ¢u cháº¡y ra tá»›i cÃ¡ máº­p, tháº­t sá»± cÃ³ thá»ƒ tiáº¿p thu cÃ¡ heo biá»ƒn áº¥m Ã¡p quan tÃ¢m sao. â€ƒâ€ƒ</p>
        <p>â€ƒâ€ƒHaibara Ai cÅ©ng nhÃ¬n láº¡i hÆ°á»›ng cÃ¡i kia bá»‹ nÃ ng coi nhÆ° tá»· tá»· ngÆ°á»i. â€ƒâ€ƒ</p>
        <p>â€ƒâ€ƒ cÃ¡i gÃ¬ saoâ€¦ RÃµ rÃ ng chÃ­nh mÃ¬nh lá»›n hÆ¡n ná»¯a Ä‘i. â€ƒâ€ƒ</p>
        <p>â€ƒâ€ƒ tá»•ng muá»‘n tháº³ng tháº¯n. NÃ ng tiÃªu tan cÆ°á»i. â€ƒâ€ƒ</p>
        <p>â€ƒâ€ƒ bÃ¡nh xe quayâ€¦â€¦Matsuda Jinpei á»Ÿ nÆ¡i Ä‘Ã³ nhÃ¬n Ä‘áº¿n Sato liá»n biáº¿t nÃ ng sáº½ nhá»› tá»›i cÃ¡i gÃ¬, rá»‘t cuá»™c lÃºc áº¥y nÃ ng cÅ©ng lÃ  tháº¥y ná»• máº¡nh ngÆ°á»i chi nháº¥t. â€ƒâ€ƒ</p>
        <p>â€ƒâ€ƒ chÃ­nh háº¯n nhÆ°ng tháº­t ra khÃ´ng cÃ³ gÃ¬, chá»§ yáº¿u lÃ â€¦ Háº¯n nhÃ¬n vá» phÃ­a bÃªn cáº¡nh báº¡n thÃ¢n. â€ƒâ€ƒ</p>
        <p>â€ƒâ€ƒ ngÆ°á»i nÃ y, tháº­t sá»± cÃ³ thá»ƒ tiáº¿p thu sao? â€ƒâ€ƒ</p>
        <p>â€ƒâ€ƒHagiwara Kenji quay Ä‘áº§u, vá»«a lÃºc Ä‘á»‘i thÆ°á»£ng háº¯n Ä‘Ã´i máº¯t. â€ƒâ€ƒ</p>
        <p>â€ƒâ€ƒ ná»­a tÃ³c dÃ i cáº£nh sÃ¡t hÆ¡i hÆ¡i nghiÃªng Ä‘áº§u, nhÆ°á»›ng mÃ y há»i: â€œLÃ m sao váº­y, tiá»ƒu Jinpei?â€ â€ƒâ€ƒ</p>
        <p>â€ƒâ€ƒMatsuda Jinpei muá»‘n nÃ³i láº¡i thÃ´i, náº¯m láº¥y báº¡n tá»‘t tay náº¯m tháº­t cháº·t: â€œâ€¦ KhÃ´ng cÃ³ gÃ¬.â€</p>



























































































































































































































































































































<!-- ===== NAV DÆ¯á»šI ===== -->
<div class="nav">
      <a class="back-link" href="../index.html">ğŸ“‘ Má»¥c lá»¥c</a>
      <a class="back-link" href="../../../index.html">ğŸ  Trang chá»§</a>
      <a class="back-link" href="../../../thu-vien-ten/name-library.html">ğŸ“– ThÆ° viá»‡n tÃªn</a>
      <a class="back-link" href="phan3.html">â® ChÆ°Æ¡ng trÆ°á»›c</a>
      <a class="back-link" href="phan5.html">â­ ChÆ°Æ¡ng sau</a>
</div>
  </main>
<!-- ================= BOOKMARK ================= -->
<script>
const NOVEL_ID = "chan-dong-so-canh-sat-do-thi-1200-van-con-tin";
const NOVEL_TITLE = "Cháº¥n Äá»™ng Sá»Ÿ Cáº£nh SÃ¡t ÄÃ´ Thá»‹ 1200 Váº¡n Con Tin ã€Xem áº¢nh Thá»ƒã€‘";
const CHAPTER_TITLE = "Pháº§n 4";
const btn = document.getElementById("bookmarkBtn");
function getBookmarks() {
  return JSON.parse(localStorage.getItem("bookmarks")) || {};
}
function isBookmarked() {
  return !!getBookmarks()[NOVEL_ID];
}
function updateButton() {
  const marked = isBookmarked();
  btn.textContent = marked ? "âœ… ÄÃ£ káº¹p" : "ğŸ“Œ Káº¹p sÃ¡ch";
  btn.classList.toggle("active", marked);
}
function toggleBookmark() {
  const bookmarks = getBookmarks();
  if (bookmarks[NOVEL_ID]) {
    delete bookmarks[NOVEL_ID];
    alert("âŒ ÄÃ£ bá» káº¹p sÃ¡ch");
  } else {
    bookmarks[NOVEL_ID] = {
      novelTitle: NOVEL_TITLE,
      chapterTitle: CHAPTER_TITLE,
      url: location.href,
      time: Date.now()
    };
    alert("ğŸ“Œ ÄÃ£ lÆ°u chÆ°Æ¡ng Ä‘ang Ä‘á»c");
  }
  localStorage.setItem("bookmarks", JSON.stringify(bookmarks));
  updateButton();
}
updateButton();
btn.addEventListener("click", toggleBookmark);
</script>
<!-- ================= HEADER SHRINK ================= -->
<script>
document.addEventListener("DOMContentLoaded", function () {

  /* =========================
     HEADER SHRINK + PADDING
  ========================== */

  const fixedHeader = document.querySelector(".fixed-top");
  const main = document.querySelector("main");

  function adjustMainPadding() {
    if (!fixedHeader || !main) return;
    main.style.paddingTop = fixedHeader.offsetHeight + 20 + "px";
  }

  function handleHeaderShrink() {
    if (!fixedHeader) return;
    fixedHeader.classList.toggle("shrink", window.scrollY > 80);
    adjustMainPadding();
  }

  window.addEventListener("scroll", handleHeaderShrink);
  window.addEventListener("resize", adjustMainPadding);
  adjustMainPadding();


  /* =========================
     SIDEBAR THÆ¯ VIá»†N (TRÃI)
  ========================== */

  const sidebar = document.getElementById("librarySidebar");
  const overlay = document.getElementById("overlay");
  const storyList = document.getElementById("storyList");
  const searchInput = document.getElementById("searchInput");

  function toggleLibrary() {
    if (!sidebar || !overlay) return;
    sidebar.classList.toggle("active");
    overlay.classList.toggle("active");
  }

  window.toggleLibrary = toggleLibrary;

  let storiesData = [];

  fetch("../../../stories.json")
    .then(res => res.json())
    .then(data => {
      storiesData = data;
      renderStories(data);
    })
    .catch(err => console.error("Lá»—i load stories.json:", err));

  function renderStories(data) {
    if (!storyList) return;

    storyList.innerHTML = "";

    const pathParts = window.location.pathname.split("/");
    const currentSlug = pathParts[2];

    data.forEach((story, index) => {
      const li = document.createElement("li");
      li.style.animationDelay = `${Math.min(index * 0.03, 0.3)}s`;

      const a = document.createElement("a");
      a.href = `/web-doc-truyen/stories/${story.slug}/`;
      a.textContent = `${story.title} (${story.chapters} chÆ°Æ¡ng)`;

      if (story.slug === currentSlug) {
        a.style.background = "#e0e7ff";
      }

      li.appendChild(a);
      storyList.appendChild(li);
    });
  }

  if (searchInput) {
    searchInput.addEventListener("input", function () {
      const keyword = this.value.toLowerCase();
      const filtered = storiesData.filter(story =>
        story.title.toLowerCase().includes(keyword)
      );
      renderStories(filtered);
    });
  }


  /* =========================
     SIDEBAR Má»¤C Lá»¤C CHÆ¯Æ NG (PHáº¢I)
  ========================== */

  const chapterSidebar = document.getElementById("chapterSidebar");
  const chapterOverlay = document.getElementById("chapterOverlay");
  const chapterList = document.getElementById("chapterList");

  function toggleChapterMenu() {
    if (!chapterSidebar || !chapterOverlay) return;
    chapterSidebar.classList.toggle("active");
    chapterOverlay.classList.toggle("active");
  }

  window.toggleChapterMenu = toggleChapterMenu;

  if (chapterList) {
    fetch("../index.html")
      .then(res => res.text())
      .then(html => {
        const parser = new DOMParser();
        const doc = parser.parseFromString(html, "text/html");

        const toc = doc.querySelector(".content ul");
        if (!toc) return;

        const currentPage = window.location.pathname.split("/").pop();

        toc.querySelectorAll("li").forEach(li => {
          const a = li.querySelector("a");
          if (!a) return;

          let href = a.getAttribute("href");

          if (href.startsWith("chapter/")) {
            href = href.replace("chapter/", "");
          }

          const newLi = document.createElement("li");
          const newA = document.createElement("a");

          newA.href = href;
          newA.textContent = a.textContent;

          if (href === currentPage) {
            newA.style.background = "#e0e7ff";
          }

          newLi.appendChild(newA);
          chapterList.appendChild(newLi);
        });
      })
      .catch(err => console.error("KhÃ´ng load Ä‘Æ°á»£c má»¥c lá»¥c:", err));
  }

});
</script>
</body>
</html>
